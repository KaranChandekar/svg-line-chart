{"version":3,"file":"line-chart.js","sources":["../src/index.mjs"],"sourcesContent":["// @format\nimport htm from \"htm\";\nimport vhtml from \"vhtml\";\nimport {\n  eachMonthOfInterval,\n  isAfter,\n  isSameDay,\n  format,\n  isEqual\n} from \"date-fns\";\nimport { paramCase } from \"param-case\";\n\nconst html = htm.bind(vhtml);\n\nconst offsetX = 10;\nconst offsetY = 5;\n\nexport function plot(data, options) {\n  const { x, labels } = scaleDates(offsetX, options.width, data.x);\n\n  const { min, max } = getMinMax(data.y, options.margin);\n  const y = scalePoints(offsetY, options.height, min, max, data.y);\n  const yPoints = generateLabelRange(min, max, options.yDistance);\n  const yScaledLabels = scalePoints(offsetY, options.height, min, max, yPoints);\n\n  const l = polyline(x, y, options.line);\n\n  return html`\n      <svg viewBox=\"0 0 ${options.width} ${options.height}\">\n        <title>${options.title}</title>\n        ${renderAxis(\n          offsetX,\n          offsetX,\n          0,\n          options.height - offsetY,\n          options.xAxis\n        )}\n        ${renderAxis(\n          offsetX,\n          options.width,\n          options.height - offsetY,\n          options.height - offsetY,\n          options.yAxis\n        )}\n        ${axisLabel(\n          0,\n          (options.height - offsetY) / 2,\n          options.yLabel.name,\n          {\n            style: \"transform: rotate(-90deg);\",\n            ...options.yLabel\n          },\n          { style: \"transform: translate(-15%, 55%)\" }\n        )}\n        ${yPoints.map((p, i) => {\n          const scaledPoint = yScaledLabels[i];\n          // NOTE: +0.5 is to center text vertically\n          return axisLabel(offsetX / 1.5, scaledPoint + 0.5, p, options.yLabel);\n        })}\n        ${yScaledLabels.map(p => {\n          return renderAxis(offsetX, options.width, p, p, options.yLabel);\n        })}\n        ${labels.map(({ pos, name }) => {\n          return axisLabel(\n            pos,\n            options.height - offsetY / 2,\n            name,\n            options.xLabel\n          );\n        })}\n        ${labels.map(({ pos }, i) => {\n          // NOTE: We don't want to draw over the y axis, hence for the first\n          // element we don't draw.\n          if (i === 0) return;\n          return renderAxis(\n            pos,\n            pos,\n            0,\n            options.height - offsetY,\n            options.xLabel\n          );\n        })}\n        ${l}\n      </svg>\n    `;\n}\n\nexport function polyline(x, y, options) {\n  options = toParamCase(options);\n\n  if (x.length !== y.length) {\n    throw new Error(\n      `x and y parameters need to be of same length. They are not: x (${\n        x.length\n      }) and y (${y.length}).`\n    );\n  }\n\n  if (x.length === 0) {\n    throw new Error(\"Length of data x and y cannot be zero\");\n  }\n\n  let points = \"\";\n  for (let i = 0; i < x.length; i++) {\n    points += `${x[i]},${y[i]} `;\n  }\n\n  // NOTE: We pop the last character as it's an unneeded space.\n  points = points.slice(0, -1);\n\n  return html`\n    <polyline ...${options} points=${points}/>\n  `;\n}\n\nexport function sortRangeAsc(range) {\n  return range.sort((a, b) => a - b);\n}\n\nexport function countUnique(range, equalityOp) {\n  if (range.length < 2) {\n    return range.length;\n  }\n  let buckets = [[range[0]]];\n\n  // NOTE: We start at `1` as we've already put element `0` in the first\n  // bucket.\n  for (let i = 1; i < range.length; i++) {\n    const date = range[i];\n    let match;\n\n    for (let bucket of buckets) {\n      if (equalityOp(date, bucket[0])) {\n        match = bucket;\n      }\n    }\n    if (match) {\n      match.push(date);\n    } else {\n      buckets.push([date]);\n    }\n  }\n  return buckets.length;\n}\n\n// NOTE: Expects sorted `range` (ASC).\nexport function pointWidth(total, range, equalityOp) {\n  const count = countUnique(range, equalityOp);\n  return total / count;\n}\n\nexport function insertInto(range, candidates) {\n  let insertedAt = [];\n  let cCopy = [...candidates];\n\n  for (let i = 0; i < range.length; i++) {\n    const date = range[i];\n    for (let j = 0; j < cCopy.length; j++) {\n      const candidate = cCopy[j];\n\n      if (isEqual(date, candidate)) {\n        insertedAt.push(i);\n        cCopy.splice(j, 1);\n        i = 0;\n      } else if (isAfter(date, candidate)) {\n        insertedAt.push(i);\n        cCopy.splice(j, 1);\n        i = 0;\n      }\n    }\n  }\n\n  if (cCopy.length > 0) {\n    for (let i = range.length; i < range.length + cCopy.length; i++) {\n      insertedAt.push(i);\n    }\n  }\n\n  return insertedAt;\n}\n\nexport function scaleDates(from, to, range, equalityOp = isSameDay) {\n  range = sortRangeAsc(range);\n\n  const pWidth = pointWidth(to - from, range, equalityOp);\n  const x = range.map((d, i) => from + i * pWidth);\n\n  const months = eachMonthOfInterval({\n    start: range[0],\n    end: range[range.length - 1]\n  });\n  const insertedAt = insertInto(range, months);\n  const names = months.map(d => format(d, \"MMM yyyy\"));\n  const labels = insertedAt.map((i, j) => ({\n    pos: from + i * pWidth,\n    name: names[j]\n  }));\n\n  return { x, labels };\n}\n\nexport function getMinMax(range, margin = 0) {\n  const max = Math.max.apply(Math, range) + margin;\n  const min = Math.min.apply(Math, range) - margin;\n\n  return {\n    min,\n    max\n  };\n}\n\nexport function scalePoints(from, to, min, max, range) {\n  const minAllowed = from;\n  const maxAllowed = to;\n\n  // NOTE: For explaination see: https://stackoverflow.com/a/31687097/1263876\n  const scale = val =>\n    to -\n    from * 2 -\n    ((maxAllowed - minAllowed) * (val - min)) / (max - min) +\n    minAllowed;\n  return range.map(scale);\n}\n\nexport function toParamCase(obj) {\n  let pcObj = {};\n\n  Object.keys(obj).forEach(key => {\n    pcObj[paramCase(key)] = obj[key];\n  });\n\n  return pcObj;\n}\n\nexport function renderAxis(x1, x2, y1, y2, options) {\n  options = toParamCase(options);\n  return html`\n    <g ...${options}>\n      <line x1=${x1} x2=${x2} y1=${y1} y2=${y2}></line>\n    </g>\n  `;\n}\n\nexport function axisLabel(x, y, text, options, containerOptions) {\n  options = toParamCase(options);\n  return html`\n    <g ...${containerOptions}>\n      <text ...${options} x=${x} y=${y}>${text}</text>\n    </g>\n  `;\n}\n\nexport function generateLabelRange(min, max, distance) {\n  const labels = [];\n  const start = Math.floor(min);\n  for (let i = start; i <= max; i++) {\n    if (i % distance === 0) {\n      labels.push(i);\n    }\n  }\n\n  return labels;\n}\n"],"names":["html","htm","bind","vhtml","offsetX","offsetY","plot","data","options","x","labels","scaleDates","width","min","max","getMinMax","y","margin","scalePoints","height","yPoints","generateLabelRange","yDistance","yScaledLabels","l","polyline","line","title","renderAxis","xAxis","yAxis","axisLabel","yLabel","name","style","map","p","i","scaledPoint","pos","xLabel","toParamCase","length","Error","points","slice","sortRangeAsc","range","sort","a","b","countUnique","equalityOp","buckets","date","match","bucket","push","pointWidth","total","count","insertInto","candidates","insertedAt","cCopy","j","candidate","isEqual","splice","isAfter","from","to","isSameDay","pWidth","d","months","eachMonthOfInterval","start","end","names","format","Math","apply","minAllowed","maxAllowed","scale","val","obj","pcObj","Object","keys","forEach","key","paramCase","x1","x2","y1","y2","text","containerOptions","distance","floor"],"mappings":"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"}